@{
    ViewData["Title"] = "Detalle del Producto";
    var productoId = ViewBag.ProductoId;
}

<div class="container mt-5">

    <div class="mb-4">
        <a href="/Home/Index" class="btn btn-danger">
            ← Volver al inicio
        </a>
    </div>

    <div class="row g-4">
        
        <div class="col-md-5">
            <img id="productoImagen" src="" alt="Producto" class="img-fluid rounded border shadow-sm" />
        </div>

     
        <div class="col-md-7">
            <div class="card shadow-sm border-danger">
                <div class="card-body">
                    <h3 id="productoNombre" class="card-title mb-3"></h3>
                    <p id="productoDescripcion" class="card-text"></p>
                    <p><strong>Precio:</strong> ₡<span id="productoPrecio"></span></p>
                    <p><strong>Stock disponible:</strong> <span id="productoStock"></span></p>
                    <p><strong>Categoría:</strong> <span id="productoCategoria"></span></p>

                    <div class="mb-3">
                        <label for="cantidad" class="form-label">Cantidad:</label>
                        <input type="number" id="cantidad" class="form-control w-25" min="1" value="1" />
                    </div>

                    <div class="d-flex gap-2">
                        <button class="btn btn-danger" onclick="agregarAlCarrito()">Agregar al carrito</button>
                        <button class="btn btn-outline-dark" onclick="agregarAFavoritos()">Agregar a favoritos</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


@section Scripts {
    <script>
        const API_URL = 'https://localhost:7155/Productos';
        const productoId = @productoId;

        function cargarDetalle(id) {
            $.ajax({
                url: `${API_URL}/${id}`,
                method: 'GET',
                success: function (producto) {
                    $("#productoImagen").attr("src", producto.imagen_url);
                    $("#productoNombre").text(producto.nombre);
                    $("#productoDescripcion").text(producto.descripcion);
                    $("#productoPrecio").text(producto.precio);
                    $("#productoStock").text(producto.stock);
                    $("#productoCategoria").text(producto.categoria_id);
                },
                error: function (xhr, status, error) {
                    console.error("Error al cargar detalle: " + error);
                }
            });
        }

        function agregarAlCarrito() {
            const cantidad = $("#cantidad").val();
            alert(`Agregado ${cantidad} unidad(es) del producto ${productoId} al carrito.`);
            
        }

        function agregarAFavoritos() {
            alert(`Producto ${productoId} agregado a favoritos.`);
            
        }

        $(document).ready(function () {
            cargarDetalle(productoId);
        });
    </script>
}
